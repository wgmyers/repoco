extends layout

block append scripts
  script(src="/js/admin.js")

block layout-content
  main.flex-shrink-0
    .container.vh-100
      if messages
        each message_arr, type in messages
          if type == "error"
            each message in message_arr
              .row
                .col-12
                  .alert.alert-danger.alert-dismissible.fade.show(role="alert") <strong>Error:</strong> #{message}
                    button.btn-close(type="button" data-bs-dismiss="alert" aria-label="Close")
          if type == "info"
            each message in message_arr
              .row
                .col-12
                  .alert.alert-info.alert-dismissible.fade.show(role="alert") #{message}
                    button.btn-close(type="button" data-bs-dismiss="alert" aria-label="Close")
      .row.align-items-center.justify-content-center
        .col-auto
          h1 Admin Page               
      .row.justify-content-center
        .col-auto
          h2 Users
      .row
        table.table.table-striped.table-hover(id="user-table")
          thead
            tr
              th(scope="col") Username
              th(scope="col") Email
              th(scope="col") Level
              th(scope="col") Sites
          tbody
            each user in users
              - var username = user['username']
              - var email = user['email']
              - var level = user['level']
              - var sites = user['sites'].join("|")
              tr(data-bs-toggle="modal" data-bs-target="#modal-admin" data-bs-username=username data-bs-email=email data-bs-level=level data-bs-sites=sites)
                each val in user
                  td= val
      .row.justify-content-center
        .col-auto
          h2 Add User
      .row.align-items-center
        .col-lg-4
        .col-lg-4
          form(action="/adduser" method="post")
            .row.justify-content-center.py-2
              label.col-lg-3.col-form-label(for="username") Username
              .col-lg-9
                input.form-control(type="text" id="username" name="username" placeholder="Username")
            .row.justify-content-center.py-2
              label.col-lg-3.col-form-label(for="email") Email
              .col-lg-9
                input.form-control(type="text" id="email" name="email" placeholder="ploni@shmoni.com")
            .row.justify-content-center.py-2
              label.col-lg-3.col-form-label(for="password") Password
              .col-lg-9
                input.form-control(type="password" id="password" name="password" placeholder="********")
            .row.justify-content-center.py-2
              .col-auto
                button.btn.btn-primary(type="submit") Create User
        .col-lg-4
          
    .modal(tabindex="-1" id="modal-admin")
      .modal-dialog.modal-dialog-centered
        .modal-content
          .modal-header
            h5.modal-title(id="modal-title") Admin Modal
            button.btn-close(type=button data-bs-dismiss="modal" aria-label="Close")
          .modal-body
            p(id="modal-text") Hello! I am an admin modal
          .modal-footer
            button.btn.btn-secondary(type=button data-bs-dismiss="modal" id="modal-cancel") Cancel
            button.btn.btn-primary(type=button id="modal-ok") Ok  
